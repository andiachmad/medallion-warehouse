version: 2

models:
  - name: gold_payment_summary
    description: "Summary of payments per type: total orders and total revenue"
    columns:
      - name: payment_method
        description: "Type of payment (e.g., credit card, boleto)"
        tests:
          - not_null
      - name: total_orders
        description: "Total number of orders for this payment type"
        tests:
          - not_null
      - name: total_revenue
        description: "Total revenue collected for this payment type"
        tests:
          - not_null

  - name: gold_product_sales_summary
    description: "Summary metrics per product category, including total items sold, total orders, and total revenue."
    columns:
      - name: Category_Name
        description: "The product category name."
        tests:
          - not_null
          - unique
          - relationships:
              to: ref('silver_products')
              field: product_category_name
      - name: Total_Items_Sold
        description: "Total number of items sold for this category."
        tests:
          - not_null
      - name: Total_Orders_Transaction
        description: "Total number of orders that include products from this category."
        tests:
          - not_null
      - name: Total_Revenue
        description: "Total revenue generated by this category."
        tests:
          - not_null
  
  - name: gold_product_review
    description: "Aggregated product review insights by category, including average score, review count, and top review title."
    columns:
      - name: product_id
        description: "Unique identifier of the product."
        tests:
          - not_null
          - relationships:
              to: ref('silver_products')
              field: product_id
      - name: category_name
        description: "The category name of the product."
        tests:
          - not_null
      - name: avg_review_score
        description: "The average review score of the product, rounded to 2 decimals."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 1
              max_value: 5
      - name: total_reviews
        description: "The total number of reviews per product."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 1
              inclusive: true
      - name: top_review_title
        description: "The most frequent review title for the product (mode of review titles)."
        tests:
          - not_null